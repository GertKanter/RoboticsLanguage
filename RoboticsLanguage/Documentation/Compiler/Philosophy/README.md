# The Robotics Language compiler philosophy

The `rol` compiler implements a generic engine that works by processing two types of information, **code** and **parameters**, thought three steps: **input**, **transformations**, and **output**.



![](../../Assets/compiler-flow.png)

In this document we will use the words _Inputs_ or _Parser_ interchangeably meaning the process of transforming text written in a particular language to an abstract syntax tree: the internal representation of the code.

The words _Outputs_ and _Code generation_ mean the process of transforming the abstract syntax tree into text documents, such as, c++ code, HTML pages, etc.

## The parameters

Parameters are any piece of information that may be relevant for the parsing, transformation, and code generation parts of the compiler.
Parameters are represented internally by a python dictionary.

All parameters can be assigned to command line flags that are loaded when the compiler is called. Parameters can also be loaded via YAML files.

Parameters can be printed in the terminal using the flag `--debug-parameters`:

```shell
rol helloworld.rol --debug-parameters
```

The previous command will probably show too much information. To print only a subset of the parameters the flag `--debug-parameters-path 'path'` can be used. For example, to see only the `globals` section, one can type:

```shell
rol helloworld.rol --debug-parameters-path 'globals'
```

which returns:

```python
{'compile': False,
 'compilerLanguage': 'en',
 'debug': False,
 'deploy': '/Users/glopes/deploy/',
 'language': 'en',
 'launch': False,
 'output': 'RosCpp',
 'removeCache': False,
 'verbose': 'none'}
```

If you type `rol -h` you will be show the full help for the compiler. The section on `globals` appears as (for more information on creating custom messages for the command line see the section on [Command line options](#command-line-options) ):

```
globals:
  -c, --compile         Compiles the output of all modules
  --compiler-language STR
                        Spoken language used by the compiler
  -d, --debug           Turn on debug features for all modules
  -p STR, --deploy-path STR
                        The path where the generated code is saved
  --language STR        Spoken language used for the robotics language file
  -l, --launch          Launches the output generated by all modules
  -o [STR [STR ...]], --output [STR [STR ...]]
                        Outputs
  --remove-cache        Deletes the compiler cache
  -v STR, --verbose STR
                        Shows verbose information for the compiler and its modules
```



Note that the flag `--debug-parameters-path` uses the [dpath](https://github.com/akesterson/dpath-python) library. Please read the _dpath_ documentation for the available search options. For example, to get all the values for the key `name` in the `Information` domain one can write:

```shell
 rol helloworld.rol --debug-parameters-path 'Information/*/name'
 ```

The compiler follows a number of steps, represented by each individual plug-in (see figure above). You can view these steps by using the `-v` or `--verbose` flag:

 ```shell
 rol helloworld.rol -v debug
 ```

 As the compiler progresses the parameters might be updated by each plug-in. You can use the flag `--debug-step` to show the state of the parameters for a particular step:

 ```shell
 rol helloworld.rol --debug-parameters-path 'Outputs' --debug-step 7
 ```

If the flag `--debug-step` is not specified, then by default the step is 1.

If you are developing a new plug-in it may happen that the full process from parsing to code generation will not work. You can interrupt the compiler at a particular step by using the flag `--debug-stop` in combination with `--debug-step`:

 ```shell
 rol helloworld.rol --debug-parameters-path 'Outputs' --debug-step 2 --debug-stop
 ```




The parameters dictionary is organised according to the following list:

- `globals` These are the main generic parameters for the compiler. These include elements such as compiler language, list of outputs, verbosity, debugging, etc. The globals are defined in the file  [`RoboticsLanguage/Base/Parameters.py`](../../RoboticsLanguage/Base/Parameters.py)

- `debug`
- `Information`
- `Inputs`
- `Transformers`
- `Outputs`
- `manifesto`
- `language`
- `messages`






## The code
Code is represented internally by an XML object.
